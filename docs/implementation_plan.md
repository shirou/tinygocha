# 実装計画

## 開発フェーズ

### フェーズ1: 基盤システム
1. **プロジェクト初期化**
   - Go modulesセットアップ
   - Ebitengine依存関係追加
   - 基本ディレクトリ構造作成

2. **データ構造実装**
   - 基本構造体定義（Unit, Group, Army, etc.）
   - Vector2D数学ライブラリ
   - TOMLローダー実装

3. **基本描画システム**
   - Ebitengineの基本セットアップ
   - ユニット描画（簡単な図形）
   - 画面サイズ・座標系定義

### フェーズ2: コアゲームロジック
1. **ユニット管理システム**
   - ユニット生成・初期化
   - ステータス管理
   - 生存状態管理

2. **移動システム**
   - 基本移動ロジック
   - 円形隊形維持システム
   - リーダー追従システム

3. **戦闘システム**
   - 攻撃判定（射程内チェック）
   - ダメージ計算
   - HP管理・死亡判定

### フェーズ3: 高度な機能
1. **リーダーシップシステム**
   - リーダー戦死時の逃走処理
   - 逃走ルート計算
   - 画面端判定

2. **地形効果システム**
   - 地形データ読み込み
   - 地形効果適用
   - 位置ベース効果計算

3. **ゲーム進行管理**
   - 配置フェーズ
   - 戦闘フェーズ
   - 結果判定

### フェーズ4: UI・UX
1. **ユーザーインターフェース**
   - ユニット選択・配置UI
   - ステータス表示
   - ミニマップ

2. **視覚効果**
   - 攻撃エフェクト
   - ダメージ表示
   - 隊形可視化

3. **音響効果**
   - 効果音
   - BGM

## ファイル構成

```
tinygocha/
├── main.go                 # エントリーポイント
├── go.mod                  # Go modules
├── go.sum
├── docs/                   # ドキュメント
│   ├── game_specification.md
│   ├── data_structure.md
│   └── implementation_plan.md
├── internal/               # 内部パッケージ
│   ├── game/              # ゲームロジック
│   │   ├── unit.go
│   │   ├── group.go
│   │   ├── army.go
│   │   ├── battle.go
│   │   └── game.go
│   ├── graphics/          # 描画システム
│   │   ├── renderer.go
│   │   ├── sprites.go
│   │   └── ui.go
│   ├── input/             # 入力処理
│   │   └── input.go
│   ├── data/              # データ管理
│   │   ├── loader.go
│   │   ├── units.go
│   │   ├── terrain.go
│   │   └── stages.go
│   └── math/              # 数学ライブラリ
│       └── vector.go
├── assets/                # ゲームアセット
│   ├── data/              # 設定ファイル
│   │   ├── units.toml
│   │   ├── terrain.toml
│   │   └── stages.toml
│   ├── images/            # 画像ファイル
│   └── sounds/            # 音声ファイル
└── cmd/                   # コマンドラインツール
    └── editor/            # 設定エディター（将来実装）
```

## 開発優先順位

### 最優先（MVP）
1. 基本的なユニット表示
2. 簡単な移動システム
3. 基本的な戦闘システム
4. TOMLからのデータ読み込み

### 高優先
1. リーダー追従システム
2. 円形隊形維持
3. 配置システム
4. 勝利条件判定

### 中優先
1. 地形効果
2. 逃走システム
3. UI改善
4. 視覚効果

### 低優先（将来拡張）
1. 複数隊形サポート
2. 魔法システム
3. 音響効果
4. 設定エディター

## 技術的考慮事項

### パフォーマンス
- ユニット数が多い場合の描画最適化
- 衝突判定の効率化（空間分割など）
- メモリ使用量の最適化

### 拡張性
- プラグイン形式でのユニット追加
- MOD対応の設計
- 設定ファイルの柔軟性

### テスト
- ユニットテスト（特に戦闘ロジック）
- 統合テスト
- パフォーマンステスト
