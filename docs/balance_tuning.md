# バランス調整記録

## 概要

TinyGocha Battleのゲームバランス調整の記録と設計思想。

## 移動速度システム

### 設計思想

#### 1. プレイアビリティ重視
- **リアリズム** < **快適性**
- **戦術性** + **レスポンシブ性**
- **視覚的明確性**

#### 2. ユニット差別化
各ユニットの役割を移動速度で表現：
- **騎兵**: 高機動力、フランク攻撃
- **歩兵**: バランス型、前線維持
- **弓兵**: 中距離キープ、ポジショニング
- **魔術師**: 後方支援、慎重な位置取り
- **重装歩兵**: 防御重視、堅実な前進

### 調整履歴

#### 第1次調整（初期実装）
```toml
# 問題: 移動が極端に遅い
infantry = 2.0
archer = 1.8
mage = 1.5
heavy_infantry = 1.5
cavalry = 3.5
```

**問題点**:
- 画面端から端まで移動に数分かかる
- ユニット間の速度差が不明確
- プレイヤーの待機時間が長い

#### 第2次調整（大幅高速化）
```toml
# 解決: 40倍高速化
infantry = 80.0      # +3900%
archer = 70.0        # +3789%
mage = 60.0          # +3900%
heavy_infantry = 50.0 # +3233%
cavalry = 120.0      # +3329%
```

**改善点**:
- 画面端から端まで約10-15秒で移動
- 騎兵の高機動力が明確に体感可能
- 戦闘のテンポが大幅改善

### 現在の速度設定

#### 基本移動速度（pixel/秒）
| ユニット種別 | 速度値 | 相対比率 | 役割 |
|-------------|--------|----------|------|
| 騎兵 | 120.0 | 150% | 高速突撃・フランク攻撃 |
| 歩兵 | 80.0 | 100% | 標準・前線維持 |
| 弓兵 | 70.0 | 87.5% | 中距離キープ |
| 魔術師 | 60.0 | 75% | 後方支援・慎重移動 |
| 重装歩兵 | 50.0 | 62.5% | 防御重視・堅実前進 |

#### 速度差の設計意図
- **騎兵 vs 歩兵**: 1.5倍（明確な機動力差）
- **歩兵 vs 重装歩兵**: 1.6倍（装備重量の影響）
- **最速 vs 最遅**: 2.4倍（戦術的多様性）

## 地形効果システム

### 設計思想

#### 1. 戦術的深度
地形による移動速度変化で戦術選択を促進：
- **平原**: 騎兵有利、高速戦闘
- **森**: 弓兵有利、中速戦闘
- **山**: 魔術師有利、低速戦闘

#### 2. バランス調整
極端な減速を避け、プレイアビリティを維持。

### 調整履歴

#### 第1次設定（過度な減速）
```toml
forest = 0.7    # -30%（過度な減速）
mountain = 0.5  # -50%（極端な減速）
plain = 1.2     # +20%
```

**問題点**:
- 山地での移動が極端に遅い
- 森でも体感的にストレス
- 地形効果が過度に戦闘を支配

#### 第2次設定（バランス改善）
```toml
forest = 0.9    # -10%（軽微な減速）
mountain = 0.8  # -20%（適度な減速）
plain = 1.3     # +30%（明確な加速）
fortress = 0.9  # -10%
town = 1.1      # +10%
```

**改善点**:
- 地形効果を体感できるが過度でない
- 平原での高速戦闘が魅力的
- 山地でも許容範囲の速度

### 現在の地形効果

#### 移動速度修正値
| 地形 | 修正値 | 効果 | 戦術的意味 |
|------|--------|------|-----------|
| 平原 | 130% | +30% | 高速戦闘・騎兵有利 |
| 街 | 110% | +10% | 軽微な加速 |
| 森 | 90% | -10% | 軽微な減速・弓兵有利 |
| 城塞 | 90% | -10% | 軽微な減速・防御有利 |
| 山 | 80% | -20% | 適度な減速・魔術師有利 |

#### 実効移動速度例（歩兵80.0基準）
| 地形 | 歩兵 | 騎兵 | 重装歩兵 |
|------|------|------|----------|
| 平原 | 104.0 | 156.0 | 65.0 |
| 街 | 88.0 | 132.0 | 55.0 |
| 森 | 72.0 | 108.0 | 45.0 |
| 城塞 | 72.0 | 108.0 | 45.0 |
| 山 | 64.0 | 96.0 | 40.0 |

## AI行動システム

### 判断頻度の調整

#### 設計思想
- **レスポンシブ性**: 素早い状況判断
- **パフォーマンス**: 過度な処理負荷回避
- **戦術性**: 適切な行動変更頻度

#### 調整履歴
```go
// 第1次設定: 遅い反応
DecisionCooldown: 0.5  // 0.5秒間隔

// 第2次設定: 高速反応
DecisionCooldown: 0.1  // 0.1秒間隔（5倍高速化）
```

### ターゲット選択の改善

#### 問題のあった距離制限
```go
// 問題のあるコード
if distance > unit.Range * 2.0 {
    return -1.0 // 除外
}
```

**問題**:
- 歩兵射程1.5 × 2 = 3.0ピクセル
- 実際の敵距離: 800ピクセル
- 結果: 全敵が除外される

#### 改善されたスコア計算
```go
// 改善されたコード
score := 100.0
score -= distance * 0.1  // 緩やかな距離減点
if distance <= unit.Range {
    score += 100.0  // 射程内ボーナス
}
```

**改善点**:
- 距離制限を撤廃
- 射程内の敵に明確な優先度
- 遠距離でも選択可能

## 戦闘バランス

### ユニット種別の役割分担

#### 騎兵（高機動アタッカー）
- **移動速度**: 120.0（最高）
- **戦術**: 高速突撃、フランク攻撃
- **地形適性**: 平原で最大効果
- **AI設定**: 攻撃的、積極的接近

#### 歩兵（バランス型）
- **移動速度**: 80.0（標準）
- **戦術**: 前線維持、汎用性
- **地形適性**: 全地形で安定
- **AI設定**: バランス型、適度な攻撃性

#### 弓兵（中距離サポート）
- **移動速度**: 70.0（やや遅）
- **戦術**: 中距離キープ、支援射撃
- **地形適性**: 森で攻撃力ボーナス
- **AI設定**: 理想距離維持、後退戦術

#### 魔術師（後方支援）
- **移動速度**: 60.0（遅）
- **戦術**: 後方支援、長距離攻撃
- **地形適性**: 山で攻撃力ボーナス
- **AI設定**: 慎重、長距離維持

#### 重装歩兵（防御特化）
- **移動速度**: 50.0（最遅）
- **戦術**: 防御重視、堅実前進
- **地形適性**: 城塞で防御ボーナス
- **AI設定**: 防御的、慎重な接近

### 戦術的多様性

#### 地形による戦術変化
- **平原戦**: 騎兵中心の高速戦闘
- **森林戦**: 弓兵活用の中距離戦闘
- **山岳戦**: 魔術師重視の長距離戦闘
- **城塞戦**: 重装歩兵による堅実な攻略

#### 軍編成の多様性
- **攻撃型**: 騎兵・歩兵中心
- **防御型**: 重装歩兵・弓兵中心
- **バランス型**: 全種類を均等配置

## 今後の調整予定

### 短期調整
- [ ] 攻撃力・防御力のバランス調整
- [ ] 射程距離の最適化
- [ ] 地形効果の微調整

### 中期調整
- [ ] 新ユニット種別の追加
- [ ] 特殊能力の実装
- [ ] 隊形効果の追加

### 長期調整
- [ ] プレイヤー設定可能なバランス
- [ ] 難易度別AI調整
- [ ] 競技バランスの検討

## 調整指針

### 基本原則
1. **プレイアビリティ最優先**
2. **視覚的明確性の確保**
3. **戦術的多様性の促進**
4. **パフォーマンスとの両立**

### 調整基準
- **移動時間**: 画面端から端まで10-20秒
- **速度差**: 最大2.5倍まで
- **地形効果**: ±30%以内
- **AI反応**: 0.1-0.2秒間隔

### 検証方法
1. **実プレイテスト**: 開発者による動作確認
2. **デバッグ機能**: 数値的な検証
3. **バランス分析**: 統計的な評価
4. **フィードバック**: ユーザー体験の収集
